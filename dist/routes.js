(()=>{var e={376:e=>{"use strict";var t={single_source_shortest_paths:function(e,n,r){var o={},a={};a[n]=0;var s,i,c,u,l,d,f,p=t.PriorityQueue.make();for(p.push(n,0);!p.empty();)for(c in i=(s=p.pop()).value,u=s.cost,l=e[i]||{})l.hasOwnProperty(c)&&(d=u+l[c],f=a[c],(void 0===a[c]||f>d)&&(a[c]=d,p.push(c,d),o[c]=i));if(void 0!==r&&void 0===a[r]){var m=["Could not find a path from ",n," to ",r,"."].join("");throw new Error(m)}return o},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],r=t;r;)n.push(r),e[r],r=e[r];return n.reverse(),n},find_path:function(e,n,r){var o=t.single_source_shortest_paths(e,n,r);return t.extract_shortest_path_from_predecessor_list(o,r)},PriorityQueue:{make:function(e){var n,r=t.PriorityQueue,o={};for(n in e=e||{},r)r.hasOwnProperty(n)&&(o[n]=r[n]);return o.queue=[],o.sorter=e.sorter||r.default_sorter,o},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var n={value:e,cost:t};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t},654:e=>{"use strict";e.exports=function(e){for(var t=[],n=e.length,r=0;r<n;r++){var o=e.charCodeAt(r);if(o>=55296&&o<=56319&&n>r+1){var a=e.charCodeAt(r+1);a>=56320&&a<=57343&&(o=1024*(o-55296)+a-56320+65536,r+=1)}o<128?t.push(o):o<2048?(t.push(o>>6|192),t.push(63&o|128)):o<55296||o>=57344&&o<65536?(t.push(o>>12|224),t.push(o>>6&63|128),t.push(63&o|128)):o>=65536&&o<=1114111?(t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(63&o|128)):t.push(239,191,189)}return new Uint8Array(t).buffer}},119:(e,t,n)=>{const r=n(363),o=n(638),a=n(141),s=n(857);function i(e,t,n,a,s){const i=[].slice.call(arguments,1),c=i.length,u="function"==typeof i[c-1];if(!u&&!r())throw new Error("Callback required as last argument");if(!u){if(c<1)throw new Error("Too few arguments provided");return 1===c?(n=t,t=a=void 0):2!==c||t.getContext||(a=n,n=t,t=void 0),new Promise((function(r,s){try{const s=o.create(n,a);r(e(s,t,a))}catch(e){s(e)}}))}if(c<2)throw new Error("Too few arguments provided");2===c?(s=n,n=t,t=a=void 0):3===c&&(t.getContext&&void 0===s?(s=a,a=void 0):(s=a,a=n,n=t,t=void 0));try{const r=o.create(n,a);s(null,e(r,t,a))}catch(e){s(e)}}t.create=o.create,t.toCanvas=i.bind(null,a.render),t.toDataURL=i.bind(null,a.renderToDataURL),t.toString=i.bind(null,(function(e,t,n){return s.render(e,n)}))},363:e=>{e.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},539:(e,t,n)=>{const r=n(137).getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];const t=Math.floor(e/7)+2,n=r(e),o=145===n?26:2*Math.ceil((n-13)/(2*t-2)),a=[n-7];for(let e=1;e<t-1;e++)a[e]=a[e-1]-o;return a.push(6),a.reverse()},t.getPositions=function(e){const n=[],r=t.getRowColCoords(e),o=r.length;for(let e=0;e<o;e++)for(let t=0;t<o;t++)0===e&&0===t||0===e&&t===o-1||e===o-1&&0===t||n.push([r[e],r[t]]);return n}},215:(e,t,n)=>{const r=n(965),o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(e){this.mode=r.ALPHANUMERIC,this.data=e}a.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=45*o.indexOf(this.data[t]);n+=o.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(o.indexOf(this.data[t]),6)},e.exports=a},520:e=>{function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){const t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=t},844:e=>{function t(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}t.prototype.set=function(e,t,n,r){const o=e*this.size+t;this.data[o]=n,r&&(this.reservedBit[o]=!0)},t.prototype.get=function(e,t){return this.data[e*this.size+t]},t.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n},t.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=t},145:(e,t,n)=>{const r=n(654),o=n(965);function a(e){this.mode=o.BYTE,"string"==typeof e&&(e=r(e)),this.data=new Uint8Array(e)}a.getBitsLength=function(e){return 8*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)},e.exports=a},944:(e,t,n)=>{const r=n(873),o=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case r.L:return o[4*(e-1)+0];case r.M:return o[4*(e-1)+1];case r.Q:return o[4*(e-1)+2];case r.H:return o[4*(e-1)+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case r.L:return a[4*(e-1)+0];case r.M:return a[4*(e-1)+1];case r.Q:return a[4*(e-1)+2];case r.H:return a[4*(e-1)+3];default:return}}},873:(e,t)=>{t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(e){return n}}},577:(e,t,n)=>{const r=n(137).getSymbolSize;t.getPositions=function(e){const t=r(e);return[[0,0],[t-7,0],[0,t-7]]}},853:(e,t,n)=>{const r=n(137),o=r.getBCHDigit(1335);t.getEncodedBits=function(e,t){const n=e.bit<<3|t;let a=n<<10;for(;r.getBCHDigit(a)-o>=0;)a^=1335<<r.getBCHDigit(a)-o;return 21522^(n<<10|a)}},670:(e,t)=>{const n=new Uint8Array(512),r=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)n[t]=e,r[e]=t,e<<=1,256&e&&(e^=285);for(let e=255;e<512;e++)n[e]=n[e-255]}(),t.log=function(e){if(e<1)throw new Error("log("+e+")");return r[e]},t.exp=function(e){return n[e]},t.mul=function(e,t){return 0===e||0===t?0:n[r[e]+r[t]]}},198:(e,t,n)=>{const r=n(965),o=n(137);function a(e){this.mode=r.KANJI,this.data=e}a.getBitsLength=function(e){return 13*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=o.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),e.put(n,13)}},e.exports=a},662:(e,t)=>{t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};function n(e,n,r){switch(e){case t.Patterns.PATTERN000:return(n+r)%2==0;case t.Patterns.PATTERN001:return n%2==0;case t.Patterns.PATTERN010:return r%3==0;case t.Patterns.PATTERN011:return(n+r)%3==0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2==0;case t.Patterns.PATTERN101:return n*r%2+n*r%3==0;case t.Patterns.PATTERN110:return(n*r%2+n*r%3)%2==0;case t.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}}t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){const t=e.size;let n=0,r=0,o=0,a=null,s=null;for(let i=0;i<t;i++){r=o=0,a=s=null;for(let c=0;c<t;c++){let t=e.get(i,c);t===a?r++:(r>=5&&(n+=r-5+3),a=t,r=1),t=e.get(c,i),t===s?o++:(o>=5&&(n+=o-5+3),s=t,o=1)}r>=5&&(n+=r-5+3),o>=5&&(n+=o-5+3)}return n},t.getPenaltyN2=function(e){const t=e.size;let n=0;for(let r=0;r<t-1;r++)for(let o=0;o<t-1;o++){const t=e.get(r,o)+e.get(r,o+1)+e.get(r+1,o)+e.get(r+1,o+1);4!==t&&0!==t||n++}return 3*n},t.getPenaltyN3=function(e){const t=e.size;let n=0,r=0,o=0;for(let a=0;a<t;a++){r=o=0;for(let s=0;s<t;s++)r=r<<1&2047|e.get(a,s),s>=10&&(1488===r||93===r)&&n++,o=o<<1&2047|e.get(s,a),s>=10&&(1488===o||93===o)&&n++}return 40*n},t.getPenaltyN4=function(e){let t=0;const n=e.data.length;for(let r=0;r<n;r++)t+=e.data[r];return 10*Math.abs(Math.ceil(100*t/n/5)-10)},t.applyMask=function(e,t){const r=t.size;for(let o=0;o<r;o++)for(let a=0;a<r;a++)t.isReserved(a,o)||t.xor(a,o,n(e,a,o))},t.getBestMask=function(e,n){const r=Object.keys(t.Patterns).length;let o=0,a=1/0;for(let s=0;s<r;s++){n(s),t.applyMask(s,e);const r=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(s,e),r<a&&(a=r,o=s)}return o}},965:(e,t,n)=>{const r=n(499),o=n(795);t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!r.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return o.testNumeric(e)?t.NUMERIC:o.testAlphanumeric(e)?t.ALPHANUMERIC:o.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,n){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+e)}}(e)}catch(e){return n}}},958:(e,t,n)=>{const r=n(965);function o(e){this.mode=r.NUMERIC,this.data=e.toString()}o.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(e){let t,n,r;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),r=parseInt(n,10),e.put(r,10);const o=this.data.length-t;o>0&&(n=this.data.substr(t),r=parseInt(n,10),e.put(r,3*o+1))},e.exports=o},94:(e,t,n)=>{const r=n(670);t.mul=function(e,t){const n=new Uint8Array(e.length+t.length-1);for(let o=0;o<e.length;o++)for(let a=0;a<t.length;a++)n[o+a]^=r.mul(e[o],t[a]);return n},t.mod=function(e,t){let n=new Uint8Array(e);for(;n.length-t.length>=0;){const e=n[0];for(let o=0;o<t.length;o++)n[o]^=r.mul(t[o],e);let o=0;for(;o<n.length&&0===n[o];)o++;n=n.slice(o)}return n},t.generateECPolynomial=function(e){let n=new Uint8Array([1]);for(let o=0;o<e;o++)n=t.mul(n,new Uint8Array([1,r.exp(o)]));return n}},638:(e,t,n)=>{const r=n(137),o=n(873),a=n(520),s=n(844),i=n(539),c=n(577),u=n(662),l=n(944),d=n(460),f=n(941),p=n(853),m=n(965),g=n(660);function h(e,t,n){const r=e.size,o=p.getEncodedBits(t,n);let a,s;for(a=0;a<15;a++)s=1==(o>>a&1),a<6?e.set(a,8,s,!0):a<8?e.set(a+1,8,s,!0):e.set(r-15+a,8,s,!0),a<8?e.set(8,r-a-1,s,!0):a<9?e.set(8,15-a-1+1,s,!0):e.set(8,15-a-1,s,!0);e.set(r-8,8,1,!0)}function y(e,t,n,o){let p;if(Array.isArray(e))p=g.fromArray(e);else{if("string"!=typeof e)throw new Error("Invalid data");{let r=t;if(!r){const t=g.rawSplit(e);r=f.getBestVersionForData(t,n)}p=g.fromString(e,r||40)}}const y=f.getBestVersionForData(p,n);if(!y)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<y)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+y+".\n")}else t=y;const v=function(e,t,n){const o=new a;n.forEach((function(t){o.put(t.mode.bit,4),o.put(t.getLength(),m.getCharCountIndicator(t.mode,e)),t.write(o)}));const s=8*(r.getSymbolTotalCodewords(e)-l.getTotalCodewordsCount(e,t));for(o.getLengthInBits()+4<=s&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(0);const i=(s-o.getLengthInBits())/8;for(let e=0;e<i;e++)o.put(e%2?17:236,8);return function(e,t,n){const o=r.getSymbolTotalCodewords(t),a=o-l.getTotalCodewordsCount(t,n),s=l.getBlocksCount(t,n),i=s-o%s,c=Math.floor(o/s),u=Math.floor(a/s),f=u+1,p=c-u,m=new d(p);let g=0;const h=new Array(s),y=new Array(s);let v=0;const E=new Uint8Array(e.buffer);for(let e=0;e<s;e++){const t=e<i?u:f;h[e]=E.slice(g,g+t),y[e]=m.encode(h[e]),g+=t,v=Math.max(v,t)}const w=new Uint8Array(o);let b,C,S=0;for(b=0;b<v;b++)for(C=0;C<s;C++)b<h[C].length&&(w[S++]=h[C][b]);for(b=0;b<p;b++)for(C=0;C<s;C++)w[S++]=y[C][b];return w}(o,e,t)}(t,n,p),E=r.getSymbolSize(t),w=new s(E);return function(e,t){const n=e.size,r=c.getPositions(t);for(let t=0;t<r.length;t++){const o=r[t][0],a=r[t][1];for(let t=-1;t<=7;t++)if(!(o+t<=-1||n<=o+t))for(let r=-1;r<=7;r++)a+r<=-1||n<=a+r||(t>=0&&t<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===t||6===t)||t>=2&&t<=4&&r>=2&&r<=4?e.set(o+t,a+r,!0,!0):e.set(o+t,a+r,!1,!0))}}(w,t),function(e){const t=e.size;for(let n=8;n<t-8;n++){const t=n%2==0;e.set(n,6,t,!0),e.set(6,n,t,!0)}}(w),function(e,t){const n=i.getPositions(t);for(let t=0;t<n.length;t++){const r=n[t][0],o=n[t][1];for(let t=-2;t<=2;t++)for(let n=-2;n<=2;n++)-2===t||2===t||-2===n||2===n||0===t&&0===n?e.set(r+t,o+n,!0,!0):e.set(r+t,o+n,!1,!0)}}(w,t),h(w,n,0),t>=7&&function(e,t){const n=e.size,r=f.getEncodedBits(t);let o,a,s;for(let t=0;t<18;t++)o=Math.floor(t/3),a=t%3+n-8-3,s=1==(r>>t&1),e.set(o,a,s,!0),e.set(a,o,s,!0)}(w,t),function(e,t){const n=e.size;let r=-1,o=n-1,a=7,s=0;for(let i=n-1;i>0;i-=2)for(6===i&&i--;;){for(let n=0;n<2;n++)if(!e.isReserved(o,i-n)){let r=!1;s<t.length&&(r=1==(t[s]>>>a&1)),e.set(o,i-n,r),a--,-1===a&&(s++,a=7)}if(o+=r,o<0||n<=o){o-=r,r=-r;break}}}(w,v),isNaN(o)&&(o=u.getBestMask(w,h.bind(null,w,n))),u.applyMask(o,w),h(w,n,o),{modules:w,version:t,errorCorrectionLevel:n,maskPattern:o,segments:p}}t.create=function(e,t){if(void 0===e||""===e)throw new Error("No input text");let n,a,s=o.M;return void 0!==t&&(s=o.from(t.errorCorrectionLevel,o.M),n=f.from(t.version),a=u.from(t.maskPattern),t.toSJISFunc&&r.setToSJISFunction(t.toSJISFunc)),y(e,n,s,a)}},460:(e,t,n)=>{const r=n(94);function o(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}o.prototype.initialize=function(e){this.degree=e,this.genPoly=r.generateECPolynomial(this.degree)},o.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const n=r.mod(t,this.genPoly),o=this.degree-n.length;if(o>0){const e=new Uint8Array(this.degree);return e.set(n,o),e}return n},e.exports=o},795:(e,t)=>{const n="[0-9]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const o="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+")(?:.|[\r\n]))+";t.KANJI=new RegExp(r,"g"),t.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=new RegExp(o,"g"),t.NUMERIC=new RegExp(n,"g"),t.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const a=new RegExp("^"+r+"$"),s=new RegExp("^"+n+"$"),i=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return a.test(e)},t.testNumeric=function(e){return s.test(e)},t.testAlphanumeric=function(e){return i.test(e)}},660:(e,t,n)=>{const r=n(965),o=n(958),a=n(215),s=n(145),i=n(198),c=n(795),u=n(137),l=n(376);function d(e){return unescape(encodeURIComponent(e)).length}function f(e,t,n){const r=[];let o;for(;null!==(o=e.exec(n));)r.push({data:o[0],index:o.index,mode:t,length:o[0].length});return r}function p(e){const t=f(c.NUMERIC,r.NUMERIC,e),n=f(c.ALPHANUMERIC,r.ALPHANUMERIC,e);let o,a;return u.isKanjiModeEnabled()?(o=f(c.BYTE,r.BYTE,e),a=f(c.KANJI,r.KANJI,e)):(o=f(c.BYTE_KANJI,r.BYTE,e),a=[]),t.concat(n,o,a).sort((function(e,t){return e.index-t.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function m(e,t){switch(t){case r.NUMERIC:return o.getBitsLength(e);case r.ALPHANUMERIC:return a.getBitsLength(e);case r.KANJI:return i.getBitsLength(e);case r.BYTE:return s.getBitsLength(e)}}function g(e,t){let n;const c=r.getBestModeForData(e);if(n=r.from(t,c),n!==r.BYTE&&n.bit<c.bit)throw new Error('"'+e+'" cannot be encoded with mode '+r.toString(n)+".\n Suggested mode is: "+r.toString(c));switch(n!==r.KANJI||u.isKanjiModeEnabled()||(n=r.BYTE),n){case r.NUMERIC:return new o(e);case r.ALPHANUMERIC:return new a(e);case r.KANJI:return new i(e);case r.BYTE:return new s(e)}}t.fromArray=function(e){return e.reduce((function(e,t){return"string"==typeof t?e.push(g(t,null)):t.data&&e.push(g(t.data,t.mode)),e}),[])},t.fromString=function(e,n){const o=function(e){const t=[];for(let n=0;n<e.length;n++){const o=e[n];switch(o.mode){case r.NUMERIC:t.push([o,{data:o.data,mode:r.ALPHANUMERIC,length:o.length},{data:o.data,mode:r.BYTE,length:o.length}]);break;case r.ALPHANUMERIC:t.push([o,{data:o.data,mode:r.BYTE,length:o.length}]);break;case r.KANJI:t.push([o,{data:o.data,mode:r.BYTE,length:d(o.data)}]);break;case r.BYTE:t.push([{data:o.data,mode:r.BYTE,length:d(o.data)}])}}return t}(p(e,u.isKanjiModeEnabled())),a=function(e,t){const n={},o={start:{}};let a=["start"];for(let s=0;s<e.length;s++){const i=e[s],c=[];for(let e=0;e<i.length;e++){const u=i[e],l=""+s+e;c.push(l),n[l]={node:u,lastCount:0},o[l]={};for(let e=0;e<a.length;e++){const s=a[e];n[s]&&n[s].node.mode===u.mode?(o[s][l]=m(n[s].lastCount+u.length,u.mode)-m(n[s].lastCount,u.mode),n[s].lastCount+=u.length):(n[s]&&(n[s].lastCount=u.length),o[s][l]=m(u.length,u.mode)+4+r.getCharCountIndicator(u.mode,t))}}a=c}for(let e=0;e<a.length;e++)o[a[e]].end=0;return{map:o,table:n}}(o,n),s=l.find_path(a.map,"start","end"),i=[];for(let e=1;e<s.length-1;e++)i.push(a.table[s[e]].node);return t.fromArray(i.reduce((function(e,t){const n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)}),[]))},t.rawSplit=function(e){return t.fromArray(p(e,u.isKanjiModeEnabled()))}},137:(e,t)=>{let n;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return r[e]},t.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!=typeof e)throw new Error('"toSJISFunc" is not a valid function.');n=e},t.isKanjiModeEnabled=function(){return void 0!==n},t.toSJIS=function(e){return n(e)}},499:(e,t)=>{t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},941:(e,t,n)=>{const r=n(137),o=n(944),a=n(873),s=n(965),i=n(499),c=r.getBCHDigit(7973);function u(e,t){return s.getCharCountIndicator(e,t)+4}function l(e,t){let n=0;return e.forEach((function(e){const r=u(e.mode,t);n+=r+e.getBitsLength()})),n}t.from=function(e,t){return i.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,n){if(!i.isValid(e))throw new Error("Invalid QR Code version");void 0===n&&(n=s.BYTE);const a=8*(r.getSymbolTotalCodewords(e)-o.getTotalCodewordsCount(e,t));if(n===s.MIXED)return a;const c=a-u(n,e);switch(n){case s.NUMERIC:return Math.floor(c/10*3);case s.ALPHANUMERIC:return Math.floor(c/11*2);case s.KANJI:return Math.floor(c/13);case s.BYTE:default:return Math.floor(c/8)}},t.getBestVersionForData=function(e,n){let r;const o=a.from(n,a.M);if(Array.isArray(e)){if(e.length>1)return function(e,n){for(let r=1;r<=40;r++)if(l(e,r)<=t.getCapacity(r,n,s.MIXED))return r}(e,o);if(0===e.length)return 1;r=e[0]}else r=e;return function(e,n,r){for(let o=1;o<=40;o++)if(n<=t.getCapacity(o,r,e))return o}(r.mode,r.getLength(),o)},t.getEncodedBits=function(e){if(!i.isValid(e)||e<7)throw new Error("Invalid QR Code version");let t=e<<12;for(;r.getBCHDigit(t)-c>=0;)t^=7973<<r.getBCHDigit(t)-c;return e<<12|t}},141:(e,t,n)=>{const r=n(369);t.render=function(e,t,n){let o=n,a=t;void 0!==o||t&&t.getContext||(o=t,t=void 0),t||(a=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),o=r.getOptions(o);const s=r.getImageWidth(e.modules.size,o),i=a.getContext("2d"),c=i.createImageData(s,s);return r.qrToImageData(c.data,e,o),function(e,t,n){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=n,t.width=n,t.style.height=n+"px",t.style.width=n+"px"}(i,a,s),i.putImageData(c,0,0),a},t.renderToDataURL=function(e,n,r){let o=r;void 0!==o||n&&n.getContext||(o=n,n=void 0),o||(o={});const a=t.render(e,n,o),s=o.type||"image/png",i=o.rendererOpts||{};return a.toDataURL(s,i.quality)}},857:(e,t,n)=>{const r=n(369);function o(e,t){const n=e.a/255,r=t+'="'+e.hex+'"';return n<1?r+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function a(e,t,n){let r=e+t;return void 0!==n&&(r+=" "+n),r}t.render=function(e,t,n){const s=r.getOptions(t),i=e.modules.size,c=e.modules.data,u=i+2*s.margin,l=s.color.light.a?"<path "+o(s.color.light,"fill")+' d="M0 0h'+u+"v"+u+'H0z"/>':"",d="<path "+o(s.color.dark,"stroke")+' d="'+function(e,t,n){let r="",o=0,s=!1,i=0;for(let c=0;c<e.length;c++){const u=Math.floor(c%t),l=Math.floor(c/t);u||s||(s=!0),e[c]?(i++,c>0&&u>0&&e[c-1]||(r+=s?a("M",u+n,.5+l+n):a("m",o,0),o=0,s=!1),u+1<t&&e[c+1]||(r+=a("h",i),i=0)):o++}return r}(c,i,s.margin)+'"/>',f='viewBox="0 0 '+u+" "+u+'"',p='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+f+' shape-rendering="crispEdges">'+l+d+"</svg>\n";return"function"==typeof n&&n(null,p),p}},369:(e,t)=>{function n(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map((function(e){return[e,e]})))),6===t.length&&t.push("F","F");const n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});const t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,o=e.scale||4;return{width:r,scale:r?4:o,margin:t,color:{dark:n(e.color.dark||"#000000ff"),light:n(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,n){const r=t.getScale(e,n);return Math.floor((e+2*n.margin)*r)},t.qrToImageData=function(e,n,r){const o=n.modules.size,a=n.modules.data,s=t.getScale(o,r),i=Math.floor((o+2*r.margin)*s),c=r.margin*s,u=[r.color.light,r.color.dark];for(let t=0;t<i;t++)for(let n=0;n<i;n++){let l=4*(t*i+n),d=r.color.light;t>=c&&n>=c&&t<i-c&&n<i-c&&(d=u[a[Math.floor((t-c)/s)*o+Math.floor((n-c)/s)]?1:0]),e[l++]=d.r,e[l++]=d.g,e[l++]=d.b,e[l]=d.a}}},415:(e,t,n)=>{"use strict";var r=n(196),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=r.useState,s=r.useEffect,i=r.useLayoutEffect,c=r.useDebugValue;function u(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=a({inst:{value:n,getSnapshot:t}}),o=r[0].inst,l=r[1];return i((function(){o.value=n,o.getSnapshot=t,u(o)&&l({inst:o})}),[e,n,t]),s((function(){return u(o)&&l({inst:o}),e((function(){u(o)&&l({inst:o})}))}),[e]),c(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:l},322:(e,t,n)=>{"use strict";e.exports=n(415)},196:e=>{"use strict";e.exports=window.React}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=n(196),t=n.n(e);const r=window.wp.domReady;var o=n.n(r);const a=window.wp.element,s=e=>{var t;return null!==(t=window.ClimbPress.i18n[e])&&void 0!==t?t:`? ${e} ?`},i=()=>window.ClimbPress.RESTNamespace,c=()=>window.ClimbPress.gradingSystems,u=e=>{var t;return null!==(t=c().find((t=>t.id==e)))&&void 0!==t?t:null},l=window.wp.apiFetch;var d=n.n(l),f=n(322);const p=()=>{},m=p(),g=Object,h=e=>e===m,y=e=>"function"==typeof e,v=(e,t)=>({...e,...t}),E=new WeakMap;let w=0;const b=e=>{const t=typeof e,n=e&&e.constructor,r=n==Date;let o,a;if(g(e)!==e||r||n==RegExp)o=r?e.toJSON():"symbol"==t?e.toString():"string"==t?JSON.stringify(e):""+e;else{if(o=E.get(e),o)return o;if(o=++w+"~",E.set(e,o),n==Array){for(o="@",a=0;a<e.length;a++)o+=b(e[a])+",";E.set(e,o)}if(n==g){o="#";const t=g.keys(e).sort();for(;!h(a=t.pop());)h(e[a])||(o+=a+":"+b(e[a])+",");E.set(e,o)}}return o},C=new WeakMap,S={},k={},N="undefined",P=typeof window!=N,I=typeof document!=N,M=(e,t)=>{const n=C.get(e);return[()=>!h(t)&&e.get(t)||S,r=>{if(!h(t)){const o=e.get(t);t in k||(k[t]=o),n[5](t,v(o,r),o||S)}},n[6],()=>!h(t)&&t in k?k[t]:!h(t)&&e.get(t)||S]};let A=!0;const[x,_]=P&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[p,p],R={isOnline:()=>A,isVisible:()=>{const e=I&&document.visibilityState;return h(e)||"hidden"!==e}},L={initFocus:e=>(I&&document.addEventListener("visibilitychange",e),x("focus",e),()=>{I&&document.removeEventListener("visibilitychange",e),_("focus",e)}),initReconnect:e=>{const t=()=>{A=!0,e()},n=()=>{A=!1};return x("online",t),x("offline",n),()=>{_("online",t),_("offline",n)}}},T=!e.useId,B=!P||"Deno"in window,D=B?e.useEffect:e.useLayoutEffect,O="undefined"!=typeof navigator&&navigator.connection,U=!B&&O&&(["slow-2g","2g"].includes(O.effectiveType)||O.saveData),H=e=>{if(y(e))try{e=e()}catch(t){e=""}const t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?b(e):"",t]};let z=0;const j=()=>++z;async function V(...e){const[t,n,r,o]=e,a=v({populateCache:!0,throwOnError:!0},"boolean"==typeof o?{revalidate:o}:o||{});let s=a.populateCache;const i=a.rollbackOnError;let c=a.optimisticData;const u=a.throwOnError;if(y(n)){const e=n,r=[],o=t.keys();for(const n of o)!/^\$(inf|sub)\$/.test(n)&&e(t.get(n)._k)&&r.push(n);return Promise.all(r.map(l))}return l(n);async function l(n){const[o]=H(n);if(!o)return;const[l,d]=M(t,o),[f,p,g,v]=C.get(t),E=()=>{const e=f[o];return(y(a.revalidate)?a.revalidate(l().data,n):!1!==a.revalidate)&&(delete g[o],delete v[o],e&&e[0])?e[0](2).then((()=>l().data)):l().data};if(e.length<3)return E();let w,b=r;const S=j();p[o]=[S,0];const k=!h(c),N=l(),P=N.data,I=N._c,A=h(I)?P:I;if(k&&(c=y(c)?c(A,P):c,d({data:c,_c:A})),y(b))try{b=b(A)}catch(e){w=e}if(b&&y(b.then)){if(b=await b.catch((e=>{w=e})),S!==p[o][0]){if(w)throw w;return b}w&&k&&(e=>"function"==typeof i?i(e):!1!==i)(w)&&(s=!0,d({data:A,_c:m}))}if(s&&!w)if(y(s)){const e=s(b,A);d({data:e,error:m,_c:m})}else d({data:b,error:m,_c:m});if(p[o][1]=j(),Promise.resolve(E()).then((()=>{d({_c:m})})),!w)return b;if(u)throw w}}const F=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},$=(e,t)=>{if(!C.has(e)){const n=v(L,t),r={},o=V.bind(m,e);let a=p;const s={},i=(e,t)=>{const n=s[e]||[];return s[e]=n,n.push(t),()=>n.splice(n.indexOf(t),1)},c=(t,n,r)=>{e.set(t,n);const o=s[t];if(o)for(const e of o)e(n,r)},u=()=>{if(!C.has(e)&&(C.set(e,[r,{},{},{},o,c,i]),!B)){const t=n.initFocus(setTimeout.bind(m,F.bind(m,r,0))),o=n.initReconnect(setTimeout.bind(m,F.bind(m,r,1)));a=()=>{t&&t(),o&&o(),C.delete(e)}}};return u(),[e,o,u,a]}return[e,C.get(e)[4]]},[J,q]=$(new Map),Y=v({onLoadingSlow:p,onSuccess:p,onError:p,onErrorRetry:(e,__,t,n,r)=>{const o=t.errorRetryCount,a=r.retryCount,s=~~((Math.random()+.5)*(1<<(a<8?a:8)))*t.errorRetryInterval;!h(o)&&a>o||setTimeout(n,s,r)},onDiscarded:p,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:U?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:U?5e3:3e3,compare:(e,t)=>b(e)==b(t),isPaused:()=>!1,cache:J,mutate:q,fallback:{}},R),K=(e,t)=>{const n=v(e,t);if(t){const{use:r,fallback:o}=e,{use:a,fallback:s}=t;r&&a&&(n.use=r.concat(a)),o&&s&&(n.fallback=v(o,s))}return n},Z=(0,e.createContext)({}),Q=P&&window.__SWR_DEVTOOLS_USE__,W=Q?window.__SWR_DEVTOOLS_USE__:[],G=W.concat((e=>(t,n,r)=>e(t,n&&((...e)=>{const[r]=H(t),[,,,o]=C.get(J);if(r.startsWith("$inf$"))return n(...e);const a=o[r];return h(a)?n(...e):(delete o[r],a)}),r)));Q&&(window.__SWR_DEVTOOLS_REACT__=e);const X=e.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((t=>{e.status="fulfilled",e.value=t}),(t=>{e.status="rejected",e.reason=t})),e)}),ee={dedupe:!0},te=(g.defineProperty((t=>{const{value:n}=t,r=(0,e.useContext)(Z),o=y(n),a=(0,e.useMemo)((()=>o?n(r):n),[o,r,n]),s=(0,e.useMemo)((()=>o?a:K(r,a)),[o,r,a]),i=a&&a.provider,c=(0,e.useRef)(m);i&&!c.current&&(c.current=$(i(s.cache||J),a));const u=c.current;return u&&(s.cache=u[0],s.mutate=u[1]),D((()=>{if(u)return u[2]&&u[2](),u[3]}),[]),(0,e.createElement)(Z.Provider,v(t,{value:s}))}),"defaultValue",{value:Y}),ne=(t,n,r)=>{const{cache:o,compare:a,suspense:s,fallbackData:i,revalidateOnMount:c,revalidateIfStale:u,refreshInterval:l,refreshWhenHidden:d,refreshWhenOffline:p,keepPreviousData:g}=r,[E,w,b,S]=C.get(o),[k,I]=H(t),A=(0,e.useRef)(!1),x=(0,e.useRef)(!1),_=(0,e.useRef)(k),R=(0,e.useRef)(n),L=(0,e.useRef)(r),O=()=>L.current,U=()=>O().isVisible()&&O().isOnline(),[z,F,$,J]=M(o,k),q=(0,e.useRef)({}).current,Y=h(i)?r.fallback[k]:i,K=(e,t)=>{for(const n in q){const r=n;if("data"===r){if(!a(e[r],t[r])){if(!h(e[r]))return!1;if(!a(ae,t[r]))return!1}}else if(t[r]!==e[r])return!1}return!0},Z=(0,e.useMemo)((()=>{const e=!!k&&!!n&&(h(c)?!O().isPaused()&&!s&&(!!h(u)||u):c),t=t=>{const n=v(t);return delete n._k,e?{isValidating:!0,isLoading:!0,...n}:n},r=z(),o=J(),a=t(r),i=r===o?a:t(o);let l=a;return[()=>{const e=t(z());return K(e,l)?(l.data=e.data,l.isLoading=e.isLoading,l.isValidating=e.isValidating,l.error=e.error,l):(l=e,e)},()=>i]}),[o,k]),Q=(0,f.useSyncExternalStore)((0,e.useCallback)((e=>$(k,((t,n)=>{K(n,t)||e()}))),[o,k]),Z[0],Z[1]),W=!A.current,G=E[k]&&E[k].length>0,te=Q.data,ne=h(te)?Y:te,re=Q.error,oe=(0,e.useRef)(ne),ae=g?h(te)?oe.current:te:ne,se=!(G&&!h(re))&&(W&&!h(c)?c:!O().isPaused()&&(s?!h(ne)&&u:h(ne)||u)),ie=!!(k&&n&&W&&se),ce=h(Q.isValidating)?ie:Q.isValidating,ue=h(Q.isLoading)?ie:Q.isLoading,le=(0,e.useCallback)((async e=>{const t=R.current;if(!k||!t||x.current||O().isPaused())return!1;let n,o,s=!0;const i=e||{},c=!b[k]||!i.dedupe,u=()=>T?!x.current&&k===_.current&&A.current:k===_.current,l={isValidating:!1,isLoading:!1},d=()=>{F(l)},f=()=>{const e=b[k];e&&e[1]===o&&delete b[k]},p={isValidating:!0};h(z().data)&&(p.isLoading=!0);try{if(c&&(F(p),r.loadingTimeout&&h(z().data)&&setTimeout((()=>{s&&u()&&O().onLoadingSlow(k,r)}),r.loadingTimeout),b[k]=[t(I),j()]),[n,o]=b[k],n=await n,c&&setTimeout(f,r.dedupingInterval),!b[k]||b[k][1]!==o)return c&&u()&&O().onDiscarded(k),!1;l.error=m;const e=w[k];if(!h(e)&&(o<=e[0]||o<=e[1]||0===e[1]))return d(),c&&u()&&O().onDiscarded(k),!1;const i=z().data;l.data=a(i,n)?i:n,c&&u()&&O().onSuccess(n,k,r)}catch(e){f();const t=O(),{shouldRetryOnError:n}=t;t.isPaused()||(l.error=e,c&&u()&&(t.onError(e,k,t),(!0===n||y(n)&&n(e))&&(O().revalidateOnFocus&&O().revalidateOnReconnect&&!U()||t.onErrorRetry(e,k,t,(e=>{const t=E[k];t&&t[0]&&t[0](3,e)}),{retryCount:(i.retryCount||0)+1,dedupe:!0}))))}return s=!1,d(),!0}),[k,o]),de=(0,e.useCallback)(((...e)=>V(o,_.current,...e)),[]);if(D((()=>{R.current=n,L.current=r,h(te)||(oe.current=te)})),D((()=>{if(!k)return;const e=le.bind(m,ee);let t=0;const n=((e,t,n)=>{const r=t[e]||(t[e]=[]);return r.push(n),()=>{const e=r.indexOf(n);e>=0&&(r[e]=r[r.length-1],r.pop())}})(k,E,((n,r={})=>{if(0==n){const n=Date.now();O().revalidateOnFocus&&n>t&&U()&&(t=n+O().focusThrottleInterval,e())}else if(1==n)O().revalidateOnReconnect&&U()&&e();else{if(2==n)return le();if(3==n)return le(r)}}));return x.current=!1,_.current=k,A.current=!0,F({_k:I}),se&&(h(ne)||B?e():(r=e,P&&typeof window.requestAnimationFrame!=N?window.requestAnimationFrame(r):setTimeout(r,1))),()=>{x.current=!0,n()};var r}),[k]),D((()=>{let e;function t(){const t=y(l)?l(z().data):l;t&&-1!==e&&(e=setTimeout(n,t))}function n(){z().error||!d&&!O().isVisible()||!p&&!O().isOnline()?t():le(ee).then(t)}return t(),()=>{e&&(clearTimeout(e),e=-1)}}),[l,d,p,k]),(0,e.useDebugValue)(ae),s&&h(ne)&&k){if(!T&&B)throw new Error("Fallback data is required when using suspense in SSR.");R.current=n,L.current=r,x.current=!1;const e=S[k];if(!h(e)){const t=de(e);X(t)}if(!h(re))throw re;{const e=le(ee);h(ae)||(e.status="fulfilled",e.value=!0),X(e)}}return{mutate:de,get data(){return q.data=!0,ae},get error(){return q.error=!0,re},get isValidating(){return q.isValidating=!0,ce},get isLoading(){return q.isLoading=!0,ue}}},function(...t){const n=v(Y,(0,e.useContext)(Z)),[r,o,a]=(e=>y(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}])(t),s=K(n,a);let i=ne;const{use:c}=s,u=(c||[]).concat(G);for(let e=u.length;e--;)i=u[e](i);return i(r,o||s.fetcher||null,s)});var ne,re,oe,ae,se=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function ie(e,t){return Array.isArray(e)?[void 0,e]:[e,t]}function ce(e){return{lang:e?.lang??undefined,message:e?.message,abortEarly:e?.abortEarly??undefined,abortPipeEarly:e?.abortPipeEarly??undefined,skipPipe:e?.skipPipe??undefined}}function ue(e,t,n,r,o){const a=t.message??function(e,t){return ae?.get(e)?.get(t)}(n,o.lang)??(e?(s=o.lang,oe?.get(s)):null)??r?.message??function(e){return re?.get(e)}(o.lang)??o.message;var s;return"function"==typeof a?a(o):a}function le(e,t,n){return{typed:e,output:t,issues:n}}function de(e){let t=typeof e;return"object"===t&&(t=e?Object.getPrototypeOf(e).constructor.name:"null"),"string"===t?`"${e}"`:"number"===t||"bigint"===t||"boolean"===t?`${e}`:t}function fe(e,t,n){const r=n.received??de(n.input),o={reason:e.type,context:n.context.type,expected:n.context.expects,received:r,message:`Invalid ${n.label}: ${n.context.expects?`Expected ${n.context.expects} but r`:"R"}eceived ${r}`,input:n.input,requirement:n.context.requirement,path:n.path,lang:t?.lang,abortEarly:t?.abortEarly,abortPipeEarly:t?.abortPipeEarly,skipPipe:t?.skipPipe};return o.message=ue(!1,n.context,n.reference,t,o),o}function pe(e,t,n,r){if(e.pipe&&!n?.skipPipe)for(const o of e.pipe){const a=o._parse(t);if(a.issues){for(const t of a.issues){const o=fe(e,n,t);r?r.push(o):r=[o]}if(n?.abortEarly||n?.abortPipeEarly)break}else t=a.output}return le(!0,t,r)}function me(e,t,n,r,o){const a=de(n),s=o?.expected??e.expects,i={reason:o?.reason??"type",context:e.type,expected:s,received:a,message:`Invalid type: Expected ${s} but received ${a}`,input:n,path:o?.path,issues:o?.issues,lang:r?.lang,abortEarly:r?.abortEarly,abortPipeEarly:r?.abortPipeEarly,skipPipe:r?.skipPipe};return i.message=ue(!0,e,t,r,i),{typed:!1,output:n,issues:[i]}}function ge(e,t){return{type:"literal",expects:de(e),async:!1,literal:e,message:t,_parse(e,t){return e===this.literal?le(!0,e):me(this,ge,e,t)}}}function he(e,t){const[n,r]=ie(e,t);return{type:"number",expects:"number",async:!1,message:n,pipe:r,_parse(e,t){return"number"!=typeof e||isNaN(e)?me(this,he,e,t):pe(this,e,t)}}}function ye(e,t){const[n,r]=ie(e,t);return{type:"string",expects:"string",async:!1,message:n,pipe:r,_parse(e,t){return"string"==typeof e?pe(this,e,t):me(this,ye,e,t)}}}Symbol("brand");var ve=["__proto__","prototype","constructor"];function Ee(e){let t;if(e)for(const n of e)if(t)for(const e of n.issues)t.push(e);else t=n.issues;return t}function we(e){return{type:"integer",expects:null,async:!1,message:e,requirement:Number.isInteger,_parse(e){return this.requirement(e)?{output:e}:function(e,t,n,r,o){return{issues:[{context:e,reference:t,input:n,label:r,received:o}]}}(this,we,e,"integer")}}}const be=function e(t,n,r,o){const[a,s,i]=function(e,t,n){if(!e||"object"==typeof e&&!Array.isArray(e)){const[r,o]=ie(t,n);return[e,r,o]}const[r,o]=ie(e,t);return[void 0,r,o]}(n,r,o);let c;return{type:"object",expects:"Object",async:!1,entries:t,rest:a,message:s,pipe:i,_parse(t,n){if(t&&"object"==typeof t){c=c??Object.entries(this.entries);let e,r=!0;const o={};for(const[a,s]of c){const i=t[a],c=s._parse(i,n);if(c.issues){const o={type:"object",origin:"value",input:t,key:a,value:i};for(const t of c.issues)t.path?t.path.unshift(o):t.path=[o],e?.push(t);if(e||(e=c.issues),n?.abortEarly){r=!1;break}}c.typed||(r=!1),(void 0!==c.output||a in t)&&(o[a]=c.output)}if(this.rest&&(!n?.abortEarly||!e))for(const a in t)if(!(a in this.entries)){const s=t[a],i=this.rest._parse(s,n);if(i.issues){const o={type:"object",origin:"value",input:t,key:a,value:s};for(const t of i.issues)t.path?t.path.unshift(o):t.path=[o],e?.push(t);if(e||(e=i.issues),n?.abortEarly){r=!1;break}}i.typed||(r=!1),o[a]=i.output}return r?pe(this,o,n,e):le(!1,o,e)}return me(this,e,t,n)}}}({id:he([we()]),name:ye(),status:function e(t,n,r){const[o,a]=ie(n,r);return{type:"union",expects:[...new Set(t.map((e=>e.expects)))].join(" | "),async:!1,options:t,message:o,pipe:a,_parse(t,n){let r,o,a;for(const e of this.options){const s=e._parse(t,n);if(s.typed){if(!s.issues){r=s;break}a?a.push(s):a=[s]}else o?o.push(s):o=[s]}if(r)return pe(this,r.output,n);if(a?.length){const r=a[0];return pe(this,r.output,n,1===a.length?r.issues:me(this,e,t,n,{reason:"union",issues:Ee(a)}).issues)}return 1===o?.length?o[0]:me(this,e,t,n,{issues:Ee(o)})}}}([ge("screwed-on"),ge("screwed-off")]),created:ye(),difficulty:he([we()]),gradingSystem:ye(),metas:function e(t,n,r,o){const[a,s,i,c]=function(e,t,n,r){if("object"==typeof t&&!Array.isArray(t)){const[o,a]=ie(n,r);return[e,t,o,a]}const[o,a]=ie(t,n);return[ye(),e,o,a]}(t,n,r,o);return{type:"record",expects:"Object",async:!1,key:a,value:s,message:i,pipe:c,_parse(t,n){if(t&&"object"==typeof t){let e,r=!0;const o={};for(const[a,s]of Object.entries(t))if(!ve.includes(a)){let i;const c=this.key._parse(a,n);if(c.issues){i={type:"record",origin:"key",input:t,key:a,value:s};for(const t of c.issues)t.path=[i],e?.push(t);if(e||(e=c.issues),n?.abortEarly){r=!1;break}}const u=this.value._parse(s,n);if(u.issues){i=i??{type:"record",origin:"value",input:t,key:a,value:s};for(const t of u.issues)t.path?t.path.unshift(i):t.path=[i],e?.push(t);if(e||(e=u.issues),n?.abortEarly){r=!1;break}}c.typed&&u.typed||(r=!1),c.typed&&(o[c.output]=u.output)}return r?pe(this,o,n,e):le(!1,o,e)}return me(this,e,t,n)}}}(ye()),communityVotesCount:he(),communityAverageDifficulty:he()}),Ce=function e(t,n,r){const[o,a]=ie(n,r);return{type:"array",expects:"Array",async:!1,item:t,message:o,pipe:a,_parse(t,n){if(Array.isArray(t)){let e,r=!0;const o=[];for(let a=0;a<t.length;a++){const s=t[a],i=this.item._parse(s,n);if(i.issues){const o={type:"array",origin:"value",input:t,key:a,value:s};for(const t of i.issues)t.path?t.path.unshift(o):t.path=[o],e?.push(t);if(e||(e=i.issues),n?.abortEarly){r=!1;break}}i.typed||(r=!1),o.push(i.output)}return r?pe(this,o,n,e):le(!1,o,e)}return me(this,e,t,n)}}}(be),Se={name:"route_name",status:"route_status",year:"created",gradingSystem:"grading_system"},ke=e=>{const t=new URLSearchParams;var n;return e.name&&t.append("name",e.name),e.status&&t.append("status",e.status),e.year&&t.append("year",String(e.year)),e.difficulty&&t.append("status",e.difficulty),e.gradingSystem&&t.append("grading_system",e.gradingSystem),e.orderBy&&t.append("order_by",null!==(n=Se?.[e.orderBy])&&void 0!==n?n:e.orderBy),e.orderDirection&&t.append("order_direction",e.orderDirection),e.page&&t.append("page",String(e.page)),e.perPage&&t.append("per_page",String(e.perPage)),e.metas&&Object.entries(e.metas).forEach((([e,n])=>{t.append(`metas[${e}]`,n)})),t},Ne="climbpress-route-table-columns",Pe=(e,t)=>e.find((e=>e.id==t)),Ie=(e,t)=>{let n=-1,r=-1;return t.grades.forEach(((t,o)=>{const a=Math.abs(t.difficulty-e);(r<0||r>a)&&(r=a,n=o)})),t.grades[n]},Me=({show:t,children:n,content:r})=>{const o=(0,e.useRef)(null);return(0,e.createElement)("div",{className:"cp-dropdown",ref:o},n,(0,e.createElement)("div",{className:"wrapper"},(0,e.createElement)("div",{className:"content"},t&&r)))},Ae=()=>(0,e.createElement)("path",{d:"M160-160v-320h160v320H160Zm240 0v-640h160v640H400Zm240 0v-440h160v440H640Z"}),xe=()=>(0,e.createElement)("path",{d:"M490.3 40.4C512.2 62.27 512.2 97.73 490.3 119.6L460.3 149.7L362.3 51.72L392.4 21.66C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7L339.7 74.34L437.7 172.3L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2L159.6 382.8C150.1 385.6 141.5 383.4 135 376.1C128.6 370.5 126.4 361 129.2 352.4L158.8 263.6C161.6 255.3 166.2 247.8 172.4 241.7V241.7zM192 63.1C209.7 63.1 224 78.33 224 95.1C224 113.7 209.7 127.1 192 127.1H96C78.33 127.1 64 142.3 64 159.1V416C64 433.7 78.33 448 96 448H352C369.7 448 384 433.7 384 416V319.1C384 302.3 398.3 287.1 416 287.1C433.7 287.1 448 302.3 448 319.1V416C448 469 405 512 352 512H96C42.98 512 0 469 0 416V159.1C0 106.1 42.98 63.1 96 63.1H192z"}),_e=()=>(0,e.createElement)("path",{fill:"currentColor",d:"M320 224H416c17.67 0 32-14.33 32-32s-14.33-32-32-32h-95.1c-17.67 0-32 14.33-32 32S302.3 224 320 224zM320 352H480c17.67 0 32-14.33 32-32s-14.33-32-32-32h-159.1c-17.67 0-32 14.33-32 32S302.3 352 320 352zM320 96h32c17.67 0 31.1-14.33 31.1-32s-14.33-32-31.1-32h-32c-17.67 0-32 14.33-32 32S302.3 96 320 96zM544 416h-223.1c-17.67 0-32 14.33-32 32s14.33 32 32 32H544c17.67 0 32-14.33 32-32S561.7 416 544 416zM192.4 330.7L160 366.1V64.03C160 46.33 145.7 32 128 32S96 46.33 96 64.03v302L63.6 330.7c-6.312-6.883-14.94-10.38-23.61-10.38c-7.719 0-15.47 2.781-21.61 8.414c-13.03 11.95-13.9 32.22-1.969 45.27l87.1 96.09c12.12 13.26 35.06 13.26 47.19 0l87.1-96.09c11.94-13.05 11.06-33.31-1.969-45.27C224.6 316.8 204.4 317.7 192.4 330.7z"}),Re=()=>(0,e.createElement)("path",{fill:"currentColor",d:"M416 288h-95.1c-17.67 0-32 14.33-32 32s14.33 32 32 32H416c17.67 0 32-14.33 32-32S433.7 288 416 288zM544 32h-223.1c-17.67 0-32 14.33-32 32s14.33 32 32 32H544c17.67 0 32-14.33 32-32S561.7 32 544 32zM352 416h-32c-17.67 0-32 14.33-32 32s14.33 32 32 32h32c17.67 0 31.1-14.33 31.1-32S369.7 416 352 416zM480 160h-159.1c-17.67 0-32 14.33-32 32s14.33 32 32 32H480c17.67 0 32-14.33 32-32S497.7 160 480 160zM192.4 330.7L160 366.1V64.03C160 46.33 145.7 32 128 32S96 46.33 96 64.03v302L63.6 330.7c-6.312-6.883-14.94-10.38-23.61-10.38c-7.719 0-15.47 2.781-21.61 8.414c-13.03 11.95-13.9 32.22-1.969 45.27l87.1 96.09c12.12 13.26 35.06 13.26 47.19 0l87.1-96.09c11.94-13.05 11.06-33.31-1.969-45.27C224.6 316.8 204.4 317.7 192.4 330.7z"}),Le=()=>(0,e.createElement)("path",{fill:"currentColor",d:"M120-520v-320h320v320H120Zm80-80h160v-160H200v160Zm-80 480v-320h320v320H120Zm80-80h160v-160H200v160Zm320-320v-320h320v320H520Zm80-80h160v-160H600v160Zm160 480v-80h80v80h-80ZM520-360v-80h80v80h-80Zm80 80v-80h80v80h-80Zm-80 80v-80h80v80h-80Zm80 80v-80h80v80h-80Zm80-80v-80h80v80h-80Zm0-160v-80h80v80h-80Zm80 80v-80h80v80h-80Z"}),Te=({icon:t,className:n=""})=>(0,e.createElement)("div",{className:n},(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"qr"!=t&&"chart"!=t?"0 0 576 512":"0 -960 960 960"},"asc"==t&&(0,e.createElement)(_e,null),"desc"==t&&(0,e.createElement)(Re,null),"edit"==t&&(0,e.createElement)(xe,null),"qr"==t&&(0,e.createElement)(Le,null),"chart"==t&&(0,e.createElement)(Ae,null))),Be=({direction:t,onClick:n,children:r})=>{const o=["cp-order-control"];return t&&o.push("active"),(0,e.createElement)("div",{className:o.join(" "),onClick:n},r,"asc"==t&&(0,e.createElement)(Te,{icon:"asc",className:"icon"}),"desc"==t&&(0,e.createElement)(Te,{icon:"desc",className:"icon"}))},De=({variant:t="primary",size:n="normal",className:r="",children:o,onClick:a})=>(0,e.createElement)("button",{className:`cp-button ${r}`,"data-variant":t,"data-size":n,onClick:a},o),Oe=({route:t,system:n,columns:r,metaStructure:o,onClickMeta:a,onEditClick:s,onClickDifficulty:i,onQRClick:c})=>(0,e.createElement)("tr",null,r.map((r=>{if("status"==r)return(0,e.createElement)("td",null,Ue[t.status]);if("difficulty"==r)return(0,e.createElement)("td",null,(0,e.createElement)(De,{variant:"outline",size:"dense",onClick:i,className:"difficulty"},Ie(t.difficulty,n).label));if("gradingSystem"==r)return(0,e.createElement)("td",null,n.name);if("created"==r)return(0,e.createElement)("td",null,new Date(Date.parse(t.created)).toLocaleDateString());if(t.metas[r]){var s;const n=t.metas[r],i=o.find((e=>e.key==r))?.options,c=i?.find((e=>e.key==n)),u=null!==(s=c?.label)&&void 0!==s?s:n;return(0,e.createElement)("td",{key:r},(0,e.createElement)("a",{href:"#",onClick:()=>a(r,n)},u))}return(0,e.createElement)("td",{key:r},t[r])})),(0,e.createElement)("td",{className:"controls"},(0,e.createElement)(De,{variant:"outline",size:"dense",onClick:s},(0,e.createElement)(Te,{icon:"edit",className:"icon"})),(0,e.createElement)(De,{variant:"outline",size:"dense",onClick:c},(0,e.createElement)(Te,{icon:"qr",className:"icon"})))),Ue={any:"⚪️","screwed-on":"🟢","screwed-off":"🔴"},He=({className:t="",columns:n={},children:r,onChange:o,state:a})=>{const[i,c]=(0,e.useState)(!1);return(0,e.createElement)("table",{className:`cp-routes-table ${t}`},(0,e.createElement)("thead",null,(0,e.createElement)("tr",null,Object.keys(n).map((t=>{if("status"==t)return(0,e.createElement)("th",{key:t},(0,e.createElement)(Me,{show:i,content:(0,e.createElement)("ul",{className:"dropdown"},(0,e.createElement)("li",{className:"dropdown-item",onClick:()=>{c(!1),o({...a,status:"any"})}},Ue.any," ",s("All")),(0,e.createElement)("li",{className:"dropdown-item",onClick:()=>{c(!1),o({...a,status:"screwed-on"})}},Ue["screwed-on"]," ",s("Screwed on")),(0,e.createElement)("li",{className:"dropdown-item",onClick:()=>{c(!1),o({...a,status:"screwed-off"})}},Ue["screwed-off"]," ",s("Screwed off")))},(0,e.createElement)("div",{className:"dropdown-button",onClick:()=>c((e=>!e))},Ue[a.status])));const r=n[t];return(0,e.createElement)("th",{key:t},(0,e.createElement)(Be,{direction:a.orderBy==t||a.orderBy==`metas.${t}`?a.orderDirection:void 0,onClick:(u=t,()=>{a.orderBy!=u?o({...a,orderBy:u,orderDirection:"asc"}):"asc"==a.orderDirection?o({...a,orderDirection:"desc"}):o({status:a.status})})},r));var u})),(0,e.createElement)("th",null))),(0,e.createElement)("tbody",null,r))},ze={status:s("Status"),name:s("Route name"),created:s("Date"),difficulty:s("Grade"),gradingSystem:s("Grading-System")},je=({columns:t,state:n,onChange:r})=>(0,e.createElement)("div",{className:"cp-columns-control"},Object.keys(t).map((o=>{const a=t[o];return(0,e.createElement)("label",{key:o,className:"item"},(0,e.createElement)("input",{type:"checkbox",onChange:(s=o,()=>{const e=n.includes(s)?n.filter((e=>e!=s)):[...n,s];r(e)}),checked:n.includes(o)})," ",a);var s})));function Ve({label:t,value:n,type:r="text",onChange:o}){return(0,e.createElement)("label",{className:"cp-input-control"},t,(0,e.createElement)("br",null),(0,e.createElement)("input",{className:"cp-input-control--input",type:r,value:n,onChange:e=>o(e.target.value)}))}function Fe({label:t,value:n,options:r,onChange:o}){return(0,e.createElement)("label",{className:"cp-select-control"},t,(0,e.createElement)("br",null),(0,e.createElement)("select",{value:n,onChange:e=>o(e.target.value)},r.map((t=>(0,e.createElement)("option",{key:t.value,value:t.value},t.label)))))}const $e=({selectedSystemId:t,difficulty:n,systems:r,onChangeSystem:o,onChangeDifficulty:a})=>{const i=r.find((e=>e.id==t));(0,e.useEffect)((()=>{i||o(r[0].id)}),[t]);const c=Ie(n,i);return(0,e.createElement)("div",{className:"cp-grading-control"},(0,e.createElement)(Fe,{label:s("Grade"),value:c.difficulty+"",options:r.find((e=>e.id==t))?.grades?.map((e=>({value:e.difficulty+"",label:e.label}))),onChange:e=>a(parseInt(e))}),(0,e.createElement)(Fe,{label:s("Grading-System"),value:t,options:r.map((e=>({value:e.id,label:e.name}))),onChange:o}))},Je=({route:t,systems:n,metaStructure:r,onChange:o,onCancel:a,onDelete:i})=>{var c;const[u,l]=(0,e.useState)(t),d=null!==(c=Pe(n,u.gradingSystem))&&void 0!==c?c:n[0],f=(0,e.useMemo)((()=>Ie(u.difficulty,d)),[u.difficulty,d.id]);(0,e.useEffect)((()=>{l(t)}),[t.id]),(0,e.useEffect)((()=>{""==u.created&&l({...u,created:(new Date).toISOString().split("T")[0]})}),[u.created]);const p=e=>t=>{l((n=>({...n,[e]:t})))},m=e=>t=>{l((n=>({...n,metas:{...n.metas,[e]:t}})))};return(0,e.createElement)("div",{className:"cp-route-form"},"function"==typeof i&&(0,e.createElement)("div",null,(0,e.createElement)(De,{variant:"outline",onClick:()=>{l((e=>({...e,status:"screwed-on"==e.status?"screwed-off":"screwed-on"})))}},"screwed-on"==u.status?"🟢 "+s("Screwed on"):"⚪️ "+s("Screwed off"))),(0,e.createElement)("div",{className:"cp-route-form__field"},(0,e.createElement)(Ve,{label:s("Route name"),value:u.name,onChange:p("name")})),(0,e.createElement)("div",{className:"cp-route-form__field"},(0,e.createElement)($e,{selectedSystemId:u.gradingSystem,difficulty:f.difficulty,systems:n,onChangeSystem:p("gradingSystem"),onChangeDifficulty:p("difficulty")})),(0,e.createElement)("div",{className:"cp-route-form__content"},(0,e.createElement)("div",{className:"cp-route-form__field"},(0,e.createElement)(Ve,{label:s("Date"),value:u.created,onChange:p("created"),type:"date"})),r.map((t=>{var n,r;return(0,e.createElement)("div",{key:t.key,className:"cp-route-form__field"},t.options.length>0?(0,e.createElement)(Fe,{label:t.label,value:null!==(n=u.metas?.[t.key])&&void 0!==n?n:"",options:[{value:"",label:""},...t.options.map((e=>({value:e.key,label:e.label})))],onChange:m(t.key)}):(0,e.createElement)(Ve,{key:t.key,label:t.label,value:null!==(r=u.metas?.[t.key])&&void 0!==r?r:"",onChange:m(t.key)}))}))),(0,e.createElement)("div",{className:"cp-route-form__controls"},"function"==typeof i&&(0,e.createElement)(De,{onClick:()=>i(),variant:"delete"},s("Delete")),(0,e.createElement)(De,{variant:"outline",onClick:a},s("Cancel")),(0,e.createElement)(De,{onClick:()=>o(u)},s("Save"))))};function qe({onClick:t,children:n}){const r=(0,a.useRef)();return(0,e.useEffect)((()=>{const e=e=>{r.current&&!r.current.contains(e.target)&&t()};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[r]),(0,e.createElement)("div",{ref:r},n)}var Ye=n(119);function Ke(){var e=function(e){var n=e.text,r=e.options,o=e.logo,a=t().useRef(null);return t().useEffect((function(){var e,t,s,i,c,u,l,d,f;if(a&&a.current&&(Ye.toCanvas(a.current,n,r,(function(e){if(e)throw e})),o)){var p=a.current.getContext("2d");if(p){var m=new Image;m.src=o.src;var g=(null===(e=null==o?void 0:o.options)||void 0===e?void 0:e.width)||30;if((null===(t=null==o?void 0:o.options)||void 0===t?void 0:t.hasOwnProperty("x"))&&(null===(s=null==o?void 0:o.options)||void 0===s?void 0:s.hasOwnProperty("y"))){var h=(null===(i=null==o?void 0:o.options)||void 0===i?void 0:i.x)||0,y=(null===(c=null==o?void 0:o.options)||void 0===c?void 0:c.y)||0;m.onload=function(){p.drawImage(m,h,y,g,g)}}if(!(null===(u=null==o?void 0:o.options)||void 0===u?void 0:u.hasOwnProperty("x"))||!(null===(l=null==o?void 0:o.options)||void 0===l?void 0:l.hasOwnProperty("y"))||void 0===(null===(d=null==o?void 0:o.options)||void 0===d?void 0:d.x)||void 0===(null===(f=null==o?void 0:o.options)||void 0===f?void 0:f.y)){var v=null==r?void 0:r.margin;v=v?8*v:0===v?0:32;var E=(((null==r?void 0:r.width)||116+v)-g)/2;m.onload=function(){p.drawImage(m,E,E,g,g)}}}}}),[a,n,r,o]),t().createElement("canvas",{ref:a})};return t().useMemo((function(){return e}),[])}function Ze({gradingSystem:t,setterGrade:n,votings:r}){const o=[...t.grades].reverse(),a=r.reduce(((e,t)=>e+t.votes),0);return(0,e.createElement)("div",{className:"cp-votes"},o.map((t=>{var o;const s=r.find((({difficulty:e})=>e==t.difficulty)),i=t.difficulty==n.difficulty,c=a>0?(null!==(o=s?.votes)&&void 0!==o?o:0)/a:0,u=Math.floor(100*c);return(0,e.createElement)("div",{key:t.difficulty,className:"item "+(i?"is-setter-grade":"")},(0,e.createElement)("div",{className:"label"},t.label),(0,e.createElement)("div",{className:"bar",style:{width:100*c+"%"}},(0,e.createElement)("span",null,u,"%")))})))}function Qe({route:t}){const[n,r]=(e=>{const{data:t=[],isLoading:n}=te(`${i()}/routes/${e}/votes`,(e=>d()({path:e})));return[t,n]})(t.id),o=c(),a=Pe(o,t.gradingSystem);if(!a)return;const s=Ie(t.difficulty,a),u=n.reduce(((e,t)=>e+t.votes),0);return(0,e.createElement)("div",null,(0,e.createElement)("h3",{style:{marginTop:0}},t.name),(0,e.createElement)("p",null,"Bewertungena aus der Community: ",u),(0,e.createElement)(Ze,{gradingSystem:a,setterGrade:s,votings:n}))}function We({currentPage:t,pages:n,onChange:r}){const[o,s]=(0,a.useState)(String(t));(0,e.useEffect)((()=>{String(t)!=o&&s(String(t))}),[t]),(0,e.useEffect)((()=>{const e=parseInt(o);""==o||isNaN(e)||e<1||e>n||r(e)}),[o]);const i=(0,a.useId)();return(0,e.createElement)("span",{className:"pagination-links"},(0,e.createElement)("span",{onClick:1==t?void 0:()=>r(1),className:"tablenav-pages-navspan button "+(1==t?"disabled":"")},"«"),(0,e.createElement)("span",{className:"tablenav-pages-navspan button "+(1==t?"disabled":""),onClick:1==t?void 0:()=>r(t-1)},"‹"),(0,e.createElement)("span",{className:"paging-input"},(0,e.createElement)("label",{htmlFor:i,className:"screen-reader-text"},"Aktuelle Seite"),(0,e.createElement)("input",{className:"current-page",id:i,type:"text",name:"paged",value:o,size:`${n}`.length,maxLength:`${n}`.length,onChange:e=>(e=>{if(""==e)return void s(e);const t=parseInt(e);isNaN(t)||s(String(t))})(e.target.value),"aria-describedby":"table-paging"}),(0,e.createElement)("span",{className:"tablenav-paging-text"}," von ",(0,e.createElement)("span",{className:"total-pages"},n))),(0,e.createElement)("span",{className:"tablenav-pages-navspan button "+(t==n?"disabled":""),onClick:t==n?void 0:()=>r(t+1)},"›"),(0,e.createElement)("span",{className:"tablenav-pages-navspan button "+(t==n?"disabled":""),onClick:t==n?void 0:()=>r(n)},"»"))}const Ge=["created","name","status","difficulty","gradingSystem"],Xe=()=>{var n,r,o,l,f;const{Image:p}={Image:(X=function(e){var n=e.text,r=e.options,o=t().useRef(null);return t().useEffect((function(){o&&o.current&&Ye.toDataURL(n,r,(function(e,t){if(e)throw e;o.current instanceof HTMLImageElement&&(o.current.src=t)}))}),[n,r,o]),t().createElement("img",{ref:o})},t().useMemo((function(){return X}),[])),Canvas:Ke(),SVG:(ee=function(e){var n=e.text,r=e.options,o=t().useRef(null);return t().useEffect((function(){Ye.toString(n,r,(function(e,t){if(e)throw e;o.current instanceof HTMLDivElement&&(o.current.innerHTML=t)}))}),[n,r]),t().createElement("div",{ref:o})},t().useMemo((function(){return ee}),[]))},m=c(),g=window.ClimbPress.routeMetaStructure,h=u(window.ClimbPress.defaultGradingSystemId),y=window.ClimbPress.availableYears,v=(0,a.useRef)(-1),E=(0,a.useRef)(null),[w,b]=(0,a.useState)(null),[C,S]=(0,a.useState)(!1),[k,N]=(0,a.useState)(!1),[P,I]=(()=>{const[t,n]=(0,a.useState)(JSON.parse(localStorage.getItem(Ne))||[]);return(0,e.useEffect)((()=>{localStorage.setItem(Ne,JSON.stringify(t))}),[t]),[t,n]})(),[M,A]=(0,a.useState)(""),[x,_]=(0,a.useState)(null),[R,L]=(0,a.useState)({status:"screwed-on"}),T=(0,a.useMemo)((()=>{const e=parseInt(M);return isNaN(e)?void 0:e}),[M]),B=null==R.orderBy?void 0:Ge.includes(null!==(n=R.orderBy)&&void 0!==n?n:"")?R.orderBy:`metas.${R.orderBy}`,D={perPage:20,status:R.status,year:T,orderBy:B,orderDirection:R.orderDirection,metas:null!=x?{[x.key]:`eq:${x.value}`}:void 0},{routes:O,page:U,totalPages:H,totalItems:z,gotoPage:j,update:V,add:F,remove:$}=(e=>{const[t,n]=(0,a.useState)(1),[r,o]=(0,a.useState)({totalItems:0,totalPages:0}),{data:s,mutate:c,isLoading:u}=te(i()+`/routes?${ke({...e,page:t})}`,(e=>d()({path:e,parse:!1}).then((e=>{var t,r;const a=e,s=parseInt(null!==(t=a.headers.get("X-WP-TotalPages"))&&void 0!==t?t:"0"),i=parseInt(null!==(r=a.headers.get("X-WP-Total"))&&void 0!==r?r:"0");return n((e=>e<=s?e:1)),o({totalItems:isNaN(i)?0:i,totalPages:isNaN(s)?0:s}),a.json()})).then((e=>{const t=function(e,t,n){const r=e._parse(t,ce(void 0));return{typed:r.typed,success:!r.issues,output:r.output,issues:r.issues}}(Ce,e);return t.success?t.output:[]}))),{keepPreviousData:!0});return{isLoading:u,routes:null!=s?s:[],totalPages:r.totalPages,totalItems:r.totalItems,page:t,nextPage(){t<r.totalPages&&n((e=>e+1))},prevPage(){t>1&&n((e=>e-1))},gotoPage(e){e<1||e>r.totalPages||n(e)},lastPage(){n(r.totalPages)},firstPage(){n(1)},update:e=>{d()({path:i()+"/routes/"+e.id,method:"PATCH",data:{name:e.name,status:e.status,difficulty:e.difficulty,grading_system:e.gradingSystem,created:e.created,metas:e.metas}}).finally((()=>{const t=s?.map((t=>({...t.id==e.id?e:t})));return c(null!=t?t:[])}))},add:e=>{d()({path:i()+"/routes",method:"POST",data:{name:e.name,status:e.status,difficulty:e.difficulty,grading_system:e.gradingSystem,created:e.created,metas:e.metas}}).then((e=>function(e,t,n){const r=e._parse(t,ce(void 0));if(r.issues)throw new se(r.issues);return r.output}(be,e))).then((e=>c([e,...null!=s?s:[]])))},remove:e=>{d()({path:i()+"/routes/"+e,method:"DELETE"}).then((()=>{var t;return c(null!==(t=s?.filter((t=>t.id!=e)))&&void 0!==t?t:[])}))}}})(D),J=function(e){const t=new URL(window.ClimbPress.exportUrl);return ke(e).forEach(((e,n)=>{t.searchParams.append(n,e)})),t}(D),q=O.find((e=>e.id==w?.routeId)),Y=()=>E.current.showModal(),K=()=>E.current.close(),Z=(0,a.useMemo)((()=>{const e={...ze};return g.forEach((t=>{e[t.key]=t.label})),e}),[g,ze]),Q=(0,a.useMemo)((()=>Object.keys(Z).filter((e=>!P.includes(e)))),[P,Z]),W=(0,a.useMemo)((()=>{const e={};return Object.keys(Z).forEach((t=>{P.includes(t)||(e[t]=Z[t])})),e}),[P,Z]),G=(e,t="")=>{const n=new URL(window.location.origin);return""!=t&&(n.pathname="route/"+t),n.searchParams.set(window.ClimbPress.votingPageParam,e+""),n.toString()};var X,ee;return(0,e.createElement)("div",{className:"cp-routes"},(0,e.createElement)("div",{className:"cp-routes__controls"},(0,e.createElement)("div",{className:"cp-routes__controls--left"},(0,e.createElement)(De,{onClick:()=>{b({type:"edit",routeId:0}),Y()}},s("New Route")),(0,e.createElement)(Me,{show:C,content:(0,e.createElement)(qe,{onClick:()=>{S(!1)}},(0,e.createElement)("div",{className:"cp-routes__columns-control"},(0,e.createElement)(je,{columns:Z,state:Q,onChange:e=>{const t=Object.keys(Z).filter((t=>!e.includes(t)));I(t)}})))},(0,e.createElement)(De,{onClick:()=>S((e=>!e)),variant:"outline"},s("Columns"))),(0,e.createElement)(Me,{show:k,content:(0,e.createElement)(qe,{onClick:()=>N(!1)},(0,e.createElement)("div",{className:"cp-routes__columns-control"},(0,e.createElement)("div",{className:"cp-routes__year-select-control",onClick:()=>{A("")}},(0,e.createElement)("input",{type:"radio",checked:""==M})," ",s("All routes")),y.map((t=>(0,e.createElement)("div",{key:t,className:"cp-routes__year-select-control",onClick:()=>{A(t)}},(0,e.createElement)("input",{type:"radio",checked:M==t})," ",t)))))},(0,e.createElement)(De,{onClick:()=>N((e=>!e)),variant:"outline"},""==M?s("All years"):M)),(0,e.createElement)(De,{onClick:()=>window.open(J),variant:"outline"},s("Export"))),(0,e.createElement)("div",{className:"cp-routes__controls--right"},(0,e.createElement)("span",{className:"displaying-num"},z," Einträge"),x?(0,e.createElement)("span",{className:"cp-routes__controls--filter",onClick:()=>{_(null)}},"mit ",null!==(r=g.find((e=>e.key==x.key))?.label)&&void 0!==r?r:"",":  ",null!==(o=((e,t,n)=>{var r;const o=n.find((t=>t.key==e));return o&&null!==(r=o?.options.find((e=>e.key==t))?.label)&&void 0!==r?r:null})(x.key,x.value,g))&&void 0!==o?o:x.value," ",(0,e.createElement)("span",{className:"dashicons dashicons-trash"})):null,(0,e.createElement)(We,{currentPage:U,pages:H,onChange:j}))),(0,e.createElement)("dialog",{ref:E},"edit"==w?.type?q?(0,e.createElement)(Je,{route:q,systems:m,metaStructure:g,onChange:e=>{K(),V(e)},onCancel:K,onDelete:()=>{const e=s('Permanently delete "%s"?').replace("%s",q.name);confirm(e)&&($(q.id),b({type:"edit",routeId:0}),E.current.close())}}):(0,e.createElement)(Je,{route:{id:v.current,name:"",status:"screwed-on",created:"",difficulty:null!==(l=h?.grades?.[0]?.difficulty)&&void 0!==l?l:0,gradingSystem:null!==(f=h?.id)&&void 0!==f?f:"",metas:{},communityVotesCount:0,communityAverageDifficulty:0},systems:m,metaStructure:g,onChange:e=>{K(),F(e),v.current--},onCancel:K}):null,"qr"==w?.type?(0,e.createElement)(qe,{onClick:()=>{b(null),K()}},(0,e.createElement)(p,{text:G(w.routeId),options:{type:"image/jpeg",quality:.6,errorCorrectionLevel:"H",margin:4,scale:4,width:300}}),(0,e.createElement)("p",null,(0,e.createElement)("a",{href:G(w.routeId)},G(w.routeId)))):null,"difficulty"==w?.type&&q?(0,e.createElement)(qe,{onClick:()=>{}},(0,e.createElement)(Qe,{route:q})):null),(0,e.createElement)(He,{state:R,onChange:L,className:"cp-routes__table",columns:W},O.map((t=>(0,e.createElement)(Oe,{key:t.id,route:t,system:Pe(m,t.gradingSystem),columns:Object.keys(W),metaStructure:g,onClickMeta:(e,t)=>{_({key:e,value:t})},onClickDifficulty:()=>{b({type:"difficulty",routeId:t.id}),Y()},onEditClick:()=>{b({type:"edit",routeId:t.id}),Y()},onQRClick:()=>{b({type:"qr",routeId:t.id}),Y()}})))),(0,e.createElement)("div",{className:"cp-routes__controls-bottom"},(0,e.createElement)("span",{className:"displaying-num"},z," Einträge")," ",(0,e.createElement)(We,{currentPage:U,pages:H,onChange:j})))};o()((()=>{(0,a.render)((0,e.createElement)(Xe,null),document.getElementById(window.ClimbPress.rootId))}))})()})();